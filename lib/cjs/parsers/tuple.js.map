{"version":3,"file":"tuple.js","names":["TUPLE_REGEX","getTupleElements","type","slice","split","map","trim","tuple","isDynamic","elements","some","element","parser","getParser","isDynamicParser","isType","test","encode","buffer","value","pack","decode","skip","length","unpack"],"sources":["../../../src/parsers/tuple.ts"],"sourcesContent":["import { getParser, isDynamicParser, pack, unpack } from '../packer';\nimport { DecodeArgs, Parser } from '../types';\n\nconst TUPLE_REGEX = /^\\((.*)\\)$/;\n\n/**\n * Get elements from a tuple type.\n *\n * @param type The tuple type to get the types for.\n * @return The elements of the tuple as string array.\n */\nexport const getTupleElements = (type: string): string[] => {\n  return type\n    .slice(1, -1)\n    .split(',')\n    .map((type) => type.trim());\n};\n\nexport const tuple: Parser<unknown[]> = {\n  /**\n   * Check if the tuple is dynamic. Tuples are dynamic if one or more elements of the tuple are dynamic.\n   *\n   * @param type The type to check.\n   * @return Whether the tuple is dynamic.\n   */\n  isDynamic(type: string): boolean {\n    const elements = getTupleElements(type);\n    return elements.some((element) => {\n      const parser = getParser(element);\n      return isDynamicParser(parser, element);\n    });\n  },\n\n  /**\n   * Check if a type is an tuple type.\n   *\n   * @param type The type to check.\n   * @return Whether the type is a tuple type.\n   */\n  isType(type: string): boolean {\n    return TUPLE_REGEX.test(type);\n  },\n\n  encode({ type, buffer, value }): Uint8Array {\n    const elements = getTupleElements(type);\n    return pack(elements, value, buffer);\n  },\n\n  decode({ type, value, skip }: DecodeArgs): unknown[] {\n    const elements = getTupleElements(type);\n    const length = elements.length * 32 - 32;\n\n    if (!isDynamicParser(this, type)) {\n      skip(length);\n    }\n\n    return unpack(elements, value);\n  }\n};\n"],"mappings":";;;;;;;AAAA;;AAGA,MAAMA,WAAW,GAAG,YAApB;;AAQO,MAAMC,gBAAgB,GAAIC,IAAD,IAA4B;EAC1D,OAAOA,IAAI,CACRC,KADI,CACE,CADF,EACK,CAAC,CADN,EAEJC,KAFI,CAEE,GAFF,EAGJC,GAHI,CAGCH,IAAD,IAAUA,IAAI,CAACI,IAAL,EAHV,CAAP;AAID,CALM;;;AAOA,MAAMC,KAAwB,GAAG;EAOtCC,SAAS,CAACN,IAAD,EAAwB;IAC/B,MAAMO,QAAQ,GAAGR,gBAAgB,CAACC,IAAD,CAAjC;IACA,OAAOO,QAAQ,CAACC,IAAT,CAAeC,OAAD,IAAa;MAChC,MAAMC,MAAM,GAAG,IAAAC,iBAAA,EAAUF,OAAV,CAAf;MACA,OAAO,IAAAG,uBAAA,EAAgBF,MAAhB,EAAwBD,OAAxB,CAAP;IACD,CAHM,CAAP;EAID,CAbqC;;EAqBtCI,MAAM,CAACb,IAAD,EAAwB;IAC5B,OAAOF,WAAW,CAACgB,IAAZ,CAAiBd,IAAjB,CAAP;EACD,CAvBqC;;EAyBtCe,MAAM,CAAC;IAAEf,IAAF;IAAQgB,MAAR;IAAgBC;EAAhB,CAAD,EAAsC;IAC1C,MAAMV,QAAQ,GAAGR,gBAAgB,CAACC,IAAD,CAAjC;IACA,OAAO,IAAAkB,YAAA,EAAKX,QAAL,EAAeU,KAAf,EAAsBD,MAAtB,CAAP;EACD,CA5BqC;;EA8BtCG,MAAM,CAAC;IAAEnB,IAAF;IAAQiB,KAAR;IAAeG;EAAf,CAAD,EAA+C;IACnD,MAAMb,QAAQ,GAAGR,gBAAgB,CAACC,IAAD,CAAjC;IACA,MAAMqB,MAAM,GAAGd,QAAQ,CAACc,MAAT,GAAkB,EAAlB,GAAuB,EAAtC;;IAEA,IAAI,CAAC,IAAAT,uBAAA,EAAgB,IAAhB,EAAsBZ,IAAtB,CAAL,EAAkC;MAChCoB,IAAI,CAACC,MAAD,CAAJ;IACD;;IAED,OAAO,IAAAC,cAAA,EAAOf,QAAP,EAAiBU,KAAjB,CAAP;EACD;;AAvCqC,CAAjC"}